## Прогнозирование температуры сплавов.

[HTML](https://github.com/SvetlanaaIvanova/Practicum_projects/blob/main/Project%2012.%20Temperature/%D0%9F%D1%80%D0%BE%D0%B3%D0%BD%D0%BE%D0%B7%D0%B8%D1%80%D0%BE%D0%B2%D0%B0%D0%BD%D0%B8%D0%B5%20%D1%82%D0%B5%D0%BC%D0%BF%D0%B5%D1%80%D0%B0%D1%82%D1%83%D1%80%D1%8B%20%D1%81%D0%BF%D0%BB%D0%B0%D0%B2%D0%BE%D0%B2.html)

[ipynb](https://github.com/SvetlanaaIvanova/Practicum_projects/blob/main/Project%2012.%20Temperature/%D0%9F%D1%80%D0%BE%D0%B3%D0%BD%D0%BE%D0%B7%D0%B8%D1%80%D0%BE%D0%B2%D0%B0%D0%BD%D0%B8%D0%B5%20%D1%82%D0%B5%D0%BC%D0%BF%D0%B5%D1%80%D0%B0%D1%82%D1%83%D1%80%D1%8B%20%D1%81%D0%BF%D0%BB%D0%B0%D0%B2%D0%BE%D0%B2.ipynb)

### Описание проекта
В целях оптимизации производственных расходов металлургическим комбинатом принято решение уменьшить потребление электроэнергии на этапе обработки стали. Для этого комбинату нужно контролировать температуру сплава. Задача проекта — построить модель, которая будет её предсказывать. 

### Навыки и инструменты
- python
- pandas
- numpy
- matplotlib.pyplot
- seaborn
- phik
- shap
- sklearn.model_selection
- sklearn.pipeline
- sklearn.metrics
- sklearn.preprocessing
- sklearn.compose
- RandomizedSearchCV
- sklearn.linear_model
- sklearn.tree
- sklearn.ensemble
- CatBoostRegressor
  
### Общий вывод
Исходные данные, предоставленные для моделирования, состоят из 7 файлов разной наполненности с общим признаком, соответствующим номеру партии сплава. Из данных исходных файлов сгенерирован новый датасет, в который включены партии, сведения по которым содержатся в каждом из 7 файлов, а также отобраны подходящие признаки или сгенерированы новые на основе предоставленных. Удалены пропуски в данных и партии, содержащие только 1 измерение температуры сплава (т.к. в них отсутствует целевой признак). Таким образом, сформирован для дальнейшего анализа датасет, состоящий из 10 признаков по 2329 партиям (исходные файлы содержали информацию по 3129-3239): первичная температура, длительность нагрева в секундах, количество нагревов, мощность нагрева, объем сыпучих материалов, количество подач сыпучих материалов, объем проволочных материалов, количество подач проволочных материалов, объема газа для продува. Также выделен целевой признак - итоговая температура.

Для определения лучшей модели машинного обучения проведено обучение 5 моделей регрессии и ансамблей моделей (модель линейной регрессии, модель Ridge, модель дерева регрессии, регрессия случайного леса и CatBoostRegressor). Лучшие результаты показала регрессия случайного леса с глубиной, равной 15, максимальным количеством для деления, равным 77, и количестовм оценщиков, равным 250. Метрика качества модели (средняя абсолютная ошибка) на обучающих данных = 6.71, на тестовых = 6.64.

Анализ важности признаков лучшей модели показал, что на решение модели наибольшее влияние оказали признаки первичной температуры и длительности нагрева в секундах: чем выше первичная температура и длительность нагрева, тем выше итоговая температура. В меньшей степени, но также увеличивают итоговую температуру и объемы материалов. Объем газа для продува, количество подач материалов и мощность нагрева, наоборот, снижают итоговую температуру, хоть и незначительно.

Анализ остатков показал относительно равномерное распределение, то есть стабильность ошибок на предсказаниях. При анализе дисперсии обнаружено увеличение разброса ошибки при предсказании более высоких температур (от 1600), что связано с малым количеством таких признаков в предоставленных данных и, как следствие, модель недообучена предсказывать подобные значения температур.

